!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("BrowserAuth",[],t):"object"==typeof exports?exports.BrowserAuth=t():e.BrowserAuth=t()}(window,(function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,r,o,n,i,s){void 0===t&&(t=!0);void 0===r&&(r="Unknown");void 0===o&&(o="Unknown");void 0===n&&(n="Unknown");void 0===i&&(i=0);void 0===s&&(s=[]);u({name:null,actionName:e,commandSurface:n,parentName:r,triggerMethod:o,durationMs:i,succeeded:t,dataFields:s})},t.logActivity=function(e,t,r,o){void 0===t&&(t=!0);void 0===r&&(r=0);void 0===o&&(o=[]);a({name:e,succeeded:t,durationMs:r,dataFields:o})},t.sendTelemetryEvent=function(e){c({kind:"event",event:e,timestamp:(new Date).getTime()})},t.sendActivityEvent=a,t.sendOtelEvent=function(e){c({kind:"otel",event:e})},t.sendUserActionEvent=u,t.addNamespaceMapping=function(e,t){c({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})},t.setEnabledState=function(e){(n=e)||(i=[])},t.shutdown=function(){return c({kind:"shutdown"}),i.length+s},t.registerEventHandler=function(e){o=e,i.forEach((function(e){return c(e)})),i=[]};var o,n=!1,i=[],s=0;function a(e){c({kind:"activity",event:e,timestamp:(new Date).getTime()})}function u(e){c({kind:"action",event:e,timestamp:(new Date).getTime()})}function c(e){n&&(o?o(e):i.length<=2e4?i.push(e):s+=1)}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts":function(e,t,r){"use strict";var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,o,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckUpnMatchIdToken=t.GetApplication=t.GetTokenOnce=t.GetToken=t.Load=void 0;var i,s,a=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts"),u=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),c=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts"),l=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts"),d=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js");function f(e,t){var r=l.TimerUtils.timer();return(s=e).enableConsoleLogging&&(u.LoggingUtils.enableConsoleLogging=s.enableConsoleLogging),s.enableUpnCheck&&(c.ValidateUtils.enableUserInfoCheck=s.enableUpnCheck),s.authority&&(s.authority=s.authority.replace(a.Constants.Authority.ProdLegacy,a.Constants.Authority.Prod)),s.idp.toLowerCase()===a.Constants.IdentityProvider.Msa.toLowerCase()?s.authority=a.Constants.Authority.Prod+a.Constants.Authority.MsaSuffix:(s.authority||(s.authority=a.Constants.Authority.Prod+a.Constants.Authority.AadSuffix),s.authority.indexOf(a.Constants.Authority.AadSuffix)<0&&("/"==s.authority.charAt(s.authority.length-1)?s.authority+=a.Constants.Authority.AadSuffix:s.authority+="/"+a.Constants.Authority.AadSuffix)),function(e){void 0===e&&(e=2e3);return new Promise((function(t,r){var o=0,n=setInterval((function(){return o+=500,function(){try{return void 0!==msal&&!!msal}catch(e){return!1}}()?(clearInterval(n),t(msal)):o>e?(clearInterval(n),r(null)):void 0}),500)}))}(s.timeoutToLoad?s.timeoutToLoad:2e3).then((function(e){var o;i=new Array;for(var n=0,l=s.appIds;n<l.length;n++){var d=l[n];if(u.LoggingUtils.log("[Load->MsalWrapper->MsalInit] "+d+": "+s.idp),d&&c.ValidateUtils.isGuid(d)){var f={applicationId:d,application:new e.PublicClientApplication({auth:{clientId:d,authority:s.authority,redirectUri:s.redirectUri?s.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!s.navigateToLoginRequestUrl||s.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:s.timeout?s.timeout:6e3}})};i.push(f),o||(o=d)}}return o?(u.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": idp["+s.idp+"], target:["+s.prefetch+"]"),Promise.all(function(e,t,r){var o=e.idp.toLowerCase()===a.Constants.IdentityProvider.Msa.toLowerCase(),n=[];console.log("configuration.prefetch:"+e.prefetch),e.prefetch&&e.prefetch.length>0&&e.prefetch.forEach((function(i){if(i){var s=p(t,e.upn,o?a.Constants.Authority.MsaSuffix:a.Constants.Authority.AadSuffix,[c.ValidateUtils.getScope(i)],r);n.push(s)}}));if(0==n.length){var i=p(t,e.upn,o?a.Constants.Authority.MsaSuffix:a.Constants.Authority.AadSuffix,[],r);n.push(i)}return n}(s,o,t)).then((function(e){return e.forEach((function(e){u.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": success: "+e.idTokenClaims.aud)})),e.length>0&&h(o).setActiveAccount(e[0].account),m(!0,t,i,r)})).catch((function(e){return u.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": error: ["+e.errorCode+"]"+e.errorMessage),m(!0,t,i,r,e.errorCode,e.errorMessage)}))):Promise.reject(m(!1,t,i,r))})).catch((function(){return u.LoggingUtils.log("[Load->MsalWrapper] msal is not loaded"),Promise.reject(m(!1,t,i,r))}))}function g(e,t,r,i,d,f,g){var m=this;void 0===f&&(f=!1);var k=l.TimerUtils.timer(),T=i||d,v=!1,y=h(t),U={},w=s.idp.toLowerCase()===a.Constants.IdentityProvider.Msa.toLowerCase();if(r&&c.ValidateUtils.isGuid(r)||(r=void 0),!e)return U.ErrorCode="missing_target",U.ErrorMessage="The provided target for BrowserAuth.GetToken is null, blank or empty",Promise.reject(C(U,r,t,f,k,void 0));if(!t||!c.ValidateUtils.isGuid(t))return U.ErrorCode="invalid_application_ID",U.ErrorMessage="The provided application ID for BrowserAuth.GetToken is null, blank, empty or with invalid format",Promise.reject(C(U,r,t,f,k,[e]));if(void 0===y||!y)return U.ErrorCode="missing_msal",U.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject(C(U,r,t,f,k,[e]));var A=function(e){return new Promise((function(r,i){return o(m,void 0,void 0,(function(){return n(this,(function(o){switch(o.label){case 0:return u.LoggingUtils.log("[GetToken->acquireToken] "+t+": popup:["+T+"]"),U={},[4,(T?y.acquireTokenPopup(e):y.acquireTokenSilent(e)).then((function(e){return U.MsalResult=e,e.accessToken?c.ValidateUtils.matchUserInfoFromIdToken(e.idToken,s)&&(f||w||c.ValidateUtils.matchUserInfoFromAccessToken(e.accessToken,s))?(U.Token=e.accessToken,u.LoggingUtils.log("[GetToken->acquireToken] "+t+": success: "+U.Token),r(U)):(U.ErrorCode="upn_mismatch",U.ErrorMessage="upn doesn't match with given upn in config",u.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),i(U)):(U.ErrorCode="no_tokens_found",U.ErrorMessage="Access token doesn't exist in auth response",u.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),i(U))})).catch((function(o){if(U.MsalResult=o,U.ErrorCode=o.errorCode,U.ErrorMessage=o.errorMessage,u.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),T||!v)return i(U);T=!0,u.LoggingUtils.log("[GetToken->acquireToken] "+t+": retry: popup:["+T+"]"),A(e).then((function(e){return r(e)})).catch((function(e){return i(e)}))}))];case 1:return o.sent(),[2]}}))}))}))},M={scopes:[c.ValidateUtils.getScope(e)],account:{username:s.upn},loginHint:s.upn,extraQueryParameters:{domain_hint:w?a.Constants.Authority.MsaSuffix:a.Constants.Authority.AadSuffix},correlationId:r,claims:g};return A(M).catch((function(e){return o(m,void 0,void 0,(function(){var i,c=this;return n(this,(function(l){switch(l.label){case 0:return i=!1,"no_tokens_found"!==e.ErrorCode?[3,2]:(u.LoggingUtils.log("[GetToken->acquireToken] "+t+": no_tokens_found"),[4,p(t,s.upn,w?a.Constants.Authority.MsaSuffix:a.Constants.Authority.AadSuffix,M.scopes,r).then((function(e){return o(c,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return u.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": success"),h(t).setActiveAccount(e.account),[4,A(M).then((function(e){i=!0,U=e})).catch((function(e){U=e}))];case 1:return r.sent(),[2]}}))}))})).catch((function(e){return o(c,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return U.ErrorCode=e.errorCode,U.ErrorMessage=e.errorMessage,u.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),"login_required"===e.errorCode&&(e.errorMessage.startsWith("AADSTS50058")||e.errorMessage.startsWith("Silent authentication was denied"))&&s.autoPopup?(v=!0,[4,A(M).then((function(e){i=!0,U=e})).catch((function(e){u.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper->Popup] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),U=e}))]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}))]);case 1:l.sent(),l.label=2;case 2:return u.LoggingUtils.log("[GetToken->acquireToken->isSuccess] "+t+": ["+i+"]"),U=C(U,r,t,f,k,M.scopes),[2,i?Promise.resolve(U):Promise.reject(U)]}}))}))})).then((function(e){return u.LoggingUtils.log("[GetToken->acquireToken] "+t+": success"),Promise.resolve(C(e,r,t,f,k,M.scopes))}))}function p(e,t,r,o,n){return h(e).ssoSilent({scopes:o,loginHint:t,extraQueryParameters:{domain_hint:r},correlationId:n})}function h(e){var t;return i&&i.some((function(r){return e&&r.applicationId&&e.toUpperCase()===r.applicationId.toUpperCase()?(t=r.application,u.LoggingUtils.log("[GetApplication] "+e+": Found"),!0):(u.LoggingUtils.log("[GetApplication] "+e+": Not Found"),!1)})),t}function m(e,t,r,o,n,i){if(!s.telemetryInstance&&"undefined"==typeof OTel){var u=[{name:a.Constants.Telemetry.Duration,int64:o.ms},{name:a.Constants.Telemetry.Succeeded,bool:!0},{name:a.Constants.Telemetry.IdentityProvider,string:s.idp.toLowerCase()},{name:a.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:a.Constants.Telemetry.LoadedApplicationCount,int64:r?r.length:0},{name:a.Constants.Telemetry.ErrorCode,string:n||"unknown"},{name:a.Constants.Telemetry.ErrorMessage,string:i||"unknown"}];d.sendTelemetryEvent({name:a.Constants.Telemetry.LoadTelemetryName,dataFields:u})}return{Telemetry:{timeToLoad:o.ms,succeeded:e,idp:s.idp.toLowerCase(),correlationId:t||"",loadedApplicationCount:r?r.length:0,errorCode:n||void 0,errorMessage:i||void 0}}}function C(e,t,r,o,n,i){if(!s.telemetryInstance&&"undefined"==typeof OTel){var u=[{name:a.Constants.Telemetry.Duration,int64:n.ms},{name:a.Constants.Telemetry.Succeeded,string:!e.Token},{name:a.Constants.Telemetry.IdentityProvider,string:s.idp.toLowerCase()},{name:a.Constants.Telemetry.ApplicationId,string:r},{name:a.Constants.Telemetry.TokenScope,string:i&&!o?i.toString():"unknown"},{name:a.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:a.Constants.Telemetry.ErrorCode,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:a.Constants.Telemetry.ErrorMessage,string:e.ErrorMessage&&!o?e.ErrorMessage:"unknown"},{name:a.Constants.Telemetry.ErrorCodeForGetToken,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:a.Constants.Telemetry.ErrorMessageForGetToken,string:e.ErrorMessage&&!o?e.ErrorMessage:"unknown"}];d.sendTelemetryEvent({name:a.Constants.Telemetry.GetTokenTelemetryName,dataFields:u})}return e.Telemetry={timeToGetToken:n.ms,succeeded:!e.Token,idp:s.idp.toLowerCase(),applicationId:r,tokenScope:i&&!o?i.toString():void 0,correlationId:t,errorCode:e.ErrorCode?e.ErrorCode:void 0,errorMessage:e.ErrorMessage&&!o?e.ErrorMessage:void 0,errorCodeForGetToken:e.ErrorCode?e.ErrorCode:void 0,errorMessageForGetToken:e.ErrorMessage&&!o?e.ErrorMessage:void 0,fromCache:!!e.MsalResult&&!!e.MsalResult.fromCache,expiresOn:e.MsalResult&&e.MsalResult.expiresOn?e.MsalResult.expiresOn.getTime()/1e3:void 0},e}function k(e,t,r,o,n,i,u){var c=[{name:a.Constants.Telemetry.Duration,int64:o.ms},{name:a.Constants.Telemetry.Succeeded,bool:!i},{name:a.Constants.Telemetry.IdentityProvider,string:s.idp.toLowerCase()},{name:a.Constants.Telemetry.ApplicationId,string:r},{name:a.Constants.Telemetry.TokenScope,string:n?n.toString():"unknown"},{name:a.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:a.Constants.Telemetry.ErrorCode,string:i||"unknown"},{name:a.Constants.Telemetry.ErrorMessage,string:u||"unknown"},{name:a.Constants.Telemetry.ErrorCodeForCheckUpn,string:i||"unknown"},{name:a.Constants.Telemetry.ErrorMessageForCheckUpn,string:u||"unknown"}];s.telemetryInstance||"undefined"!=typeof OTel||d.sendTelemetryEvent({name:a.Constants.Telemetry.CheckUpnTelemetryName,dataFields:c}),e.Telemetry={timeToCheckUPN:o.ms,succeeded:!i,idp:s.idp.toLowerCase(),applicationId:r,tokenScope:n?n.toString():void 0,correlationId:t,errorCode:i,errorMessage:u,errorCodeForCheckUPN:i,errorMessageForCheckUPN:u}}d.addNamespaceMapping("Office.Identity.WebAuth.BrowserAuth","5c65bbc4edbf480d9637ace04d62bd98-12844893-8ab9-4dde-b850-5612cb12e0f2-7822"),t.Load=f,t.GetToken=g,t.GetTokenOnce=function(e,t,r,o){return void 0===r&&(r=!1),void 0===o&&(o=!1),f({idp:r?a.Constants.IdentityProvider.Msa.toLowerCase():a.Constants.IdentityProvider.Aad.toLowerCase(),appIds:[t],authority:o?a.Constants.Authority.Ppe:a.Constants.Authority.Prod,upn:"",prefetch:[e],autoPopup:!0,enableConsoleLogging:!0}).then((function(){return g(e,t,void 0,!0)})).catch((function(e){return Promise.reject(e)}))},t.GetApplication=h,t.CheckUpnMatchIdToken=function(e,t){var r=l.TimerUtils.timer();t&&c.ValidateUtils.isGuid(t)||(t=void 0);var o={};if(!e||!c.ValidateUtils.isGuid(e))return o.ErrorCode="invalid_application_ID",o.ErrorMessage="The provided application ID for BrowserAuth.CheckUpnMatchIdToken is null, blank, empty or with invalid format",k(o,t,e,r,void 0,o.ErrorCode,o.ErrorMessage),Promise.reject(o);var n=h(e);if(void 0===n||!n)return o.ErrorCode="missing_msal",o.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject();var i=[e];return new Promise((function(a,l){var d=n.getAccountByUsername(s.upn);u.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": Calls acquireTokenSilent"),n.acquireTokenSilent({scopes:i,account:d,correlationId:t}).then((function(n){if(o.IsUpnMatch=c.ValidateUtils.matchUserInfoFromIdToken(n.idToken,s),o.IsUpnMatch)return k(o,t,e,r,i),a(o)})).catch((function(n){return o.ErrorCode=n.errorCode,o.ErrorMessage=n.errorMessage,u.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": error: "+o.ErrorMessage),o.IsUpnMatch=!1,k(o,t,e,r,i,n.errorCode,n.errorMessage),l(o)}))}))}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0,function(e){var t=function(){function e(){}return e.Aad="aad",e.Msa="msa",e}();e.IdentityProvider=t;var r=function(){function e(){}return e.RequestAuthConfig="RequestAuthConfig",e.ResponseAuthConfig="ResponseAuthConfig",e.iFrameIdTokenPrefix="msalIdTokenFrame",e.iFramePrefix="msalRenewFrame",e}();e.PostMessageType=r;var o=function(){function e(){}return e.Prod="https://login.microsoftonline.com/",e.ProdLegacy="https://login.windows.net/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="organizations",e.MsaSuffix="consumers",e.DefaultTarget="https://graph.microsoft.com",e}();e.Authority=o;var n=function(){function e(){}return e.OtelInstance="otel",e.CheckUpnTelemetryName="Office.Identity.WebAuth.BrowserAuth.CheckUpn",e.GetTokenTelemetryName="Office.Identity.WebAuth.BrowserAuth.GetToken",e.LoadTelemetryName="Office.Identity.WebAuth.BrowserAuth.Load",e.Duration="Duration",e.Succeeded="Succeeded",e.ApplicationId="ApplicationId",e.CorrelationId="CorrelationId",e.IdentityProvider="IdentityProvider",e.LoadedApplicationCount="LoadedApplicationCount",e.TokenScope="TokenScope",e.ErrorCode="ErrorCode",e.ErrorMessage="ErrorMessage",e.ErrorCodeForLoad="ErrorCodeForLoad",e.ErrorMessageForLoad="ErrorMessageForLoad",e.ErrorCodeForGetToken="ErrorCodeForGetToken",e.ErrorMessageForGetToken="ErrorMessageForGetToken",e.ErrorCodeForCheckUpn="ErrorCodeForCheckUpn",e.ErrorMessageForCheckUpn="ErrorMessageForCheckUpn",e}();e.Telemetry=n}(t.Constants||(t.Constants={}))},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractUtils=void 0;var o=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),n=function(){function e(){}return e.extractToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=this.base64Decode(r);return n?JSON.parse(n):(o.LoggingUtils.log("The returned token could not be base64 url safe decoded."),null)}catch(e){o.LoggingUtils.error("The returned token could not be decoded"+e)}return null},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.decodeJwt=function(e){if("undefined"===e||!e||0===e.length)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(o.LoggingUtils.warn("The returned access_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e}();t.ExtractUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingUtils=void 0;var o=function(){function e(){}return e.log=function(e,t){return!!this.shouldProceed(t)&&(console.log(e),!0)},e.warn=function(e,t){return!!this.shouldProceed(t)&&(console.warn(e),!0)},e.error=function(e,t){return!!this.shouldProceed(t)&&(console.error(e),!0)},e.shouldProceed=function(e){return!(null!=e&&void 0!==e&&!e)&&!(null==e&&void 0===e&&!this.enableConsoleLogging)},e.enableConsoleLogging=!1,e}();t.LoggingUtils=o},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimerUtils=void 0;var o=function(){function e(){}return e.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds/1e3)+"s"},get formattedMs(){return this.ms+"ms"}}},e}();t.TimerUtils=o},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidateUtils=void 0;var o=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts"),n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),i=function(){function e(){}return e.getScope=function(e){return["HTTPS:","API:"].some((function(t){return e.toLocaleUpperCase().startsWith(t)}))||this.isGuid(e)?e+"/.default":e},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.matchUserInfoFromIdToken=function(e,t){if(!this.enableUserInfoCheck)return n.LoggingUtils.log("Skip user info check of id token, returning true"),!0;if(!t||!t.upn)return n.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=o.ExtractUtils.extractToken(e);return!r||(!!(r&&t.puid&&r.puid&&r.puid.toLowerCase()===t.puid.toLowerCase())||(!(!r||!r.preferred_username||r.preferred_username.toLowerCase()!==t.upn.toLowerCase())||(n.LoggingUtils.log("provided Upn/Puid do not match Upn extracted from id token"),!1)))},e.matchUserInfoFromAccessToken=function(e,t){if(!this.enableUserInfoCheck)return n.LoggingUtils.log("Skip user info check of access token, returning true"),!0;if(!t||!t.upn)return n.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=o.ExtractUtils.extractToken(e);return!r||(!!(r&&t.puid&&r.puid&&r.puid.toLowerCase()===t.puid.toLowerCase())||(!(!r||!r.upn||r.upn.toLowerCase()!==t.upn.toLowerCase())||(n.LoggingUtils.log("provided Upn/Puid do not match Upn extracted from access token"),!1)))},e.enableUserInfoCheck=!1,e}();t.ValidateUtils=i},0:function(e,t,r){r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js"),e.exports=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts")}})}));